---
import BlogLayout from "../layouts/BlogLayout.astro";

const posts = await Astro.glob("./posts/*.md");

// Nach Datum sortieren, neueste oben
posts.sort((a, b) => {
  const da = a.frontmatter.date ? new Date(a.frontmatter.date).getTime() : 0;
  const db = b.frontmatter.date ? new Date(b.frontmatter.date).getTime() : 0;
  return db - da;
});
---

<BlogLayout title="Dev Notes" description="Lernlog zu TypeScript, Testing, Next & Co.">
  <header class="page-header">
    <div class="page-kicker">Learning Log</div>
    <h1 class="page-title">Entwickler-Notizen</h1>
    <p class="page-subtitle">
      Kurze Einträge zu dem, was ich aktuell lerne – als Referenz für mich
      selbst und als Portfolio für spätere Bewerbungen.
    </p>
  </header>

  <section class="post-list">
    {posts.map((post) => {
      const { title, description, date, tag } = post.frontmatter;
      const url = post.url;

      const displayDate = date
        ? new Date(date).toLocaleDateString("de-DE")
        : null;

      return (
        <a href={url} class="post-card">
          <div class="post-title-row">
            <h2 class="post-title">{title}</h2>
            {displayDate && <span class="post-date">{displayDate}</span>}
          </div>
          {description && (
            <p class="post-description">
              {description}
            </p>
          )}
          <div class="post-meta">
            {tag && <span class="post-pill">{tag}</span>}
            <span>Markdown Note</span>
          </div>
        </a>
      );
    })}
  </section>
</BlogLayout>
